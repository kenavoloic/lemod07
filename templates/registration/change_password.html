<!-- templates/registration/change_password.html -->
<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{{ title }}</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	{% load static %}
	<link href="{% static 'css/auth.css' %}" rel="stylesheet">
	</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
		<div class="container">
			<a class="navbar-brand" href="{% url 'suivi_conducteurs:dashboard' %}">
				<i class="fas me-2"></i>Suivi Conducteurs
			</a>
			<div class="navbar-nav ms-auto">
				<a class="nav-link" href="{% url 'user_profile' %}">
					<i class="fas fa-user me-1"></i>Mon Profil
				</a>
				<a class="nav-link" href="{% url 'user_logout' %}">
					<i class="fas fa-sign-out-alt me-1"></i>Déconnexion
				</a>
			</div>
		</div>
	</nav>

	<div class="container mt-4">
		<div class="row justify-content-center">
			<div class="col-md-6">
				<div class="card">
					<div class="card-header bg-warning text-dark">
						<h4 class="card-title mb-0">
							<i class="fas fa-key me-2"></i>{{ title }}
						</h4>
					</div>
					<div class="card-body">
						{% if messages %}
						{% for message in messages %}
						<div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
							{{ message }}
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
						</div>
						{% endfor %}
						{% endif %}

						<div class="alert alert-info">
							<i class="fas fa-info-circle me-2"></i>
							Pour votre sécurité, veuillez entrer votre mot de passe actuel puis choisir un nouveau mot
							de passe.
						</div>

						<form method="post">
							{% csrf_token %}

							<div class="mb-3">
								<label for="{{ form.old_password.id_for_label }}" class="form-label">
									<i class="fas fa-lock me-2"></i>Mot de passe actuel
								</label>
								<input type="password"
									class="form-control {% if form.old_password.errors %}is-invalid{% endif %}"
									name="{{ form.old_password.name }}" id="{{ form.old_password.id_for_label }}"
									required>
								{% if form.old_password.errors %}
								<div class="invalid-feedback">
									{% for error in form.old_password.errors %}{{ error }}{% endfor %}
								</div>
								{% endif %}
							</div>

							<div class="mb-3">
								<label for="{{ form.new_password1.id_for_label }}" class="form-label">
									<i class="fas fa-key me-2"></i>Nouveau mot de passe
								</label>
								<input type="password"
									class="form-control {% if form.new_password1.errors %}is-invalid{% endif %}"
									name="{{ form.new_password1.name }}" id="{{ form.new_password1.id_for_label }}"
									required>
								{% if form.new_password1.errors %}
								<div class="invalid-feedback">
									{% for error in form.new_password1.errors %}{{ error }}{% endfor %}
								</div>
								{% endif %}
								<div class="form-text">
									<small>
										<i class="fas fa-shield-alt me-1"></i>
										Le mot de passe doit contenir au moins 8 caractères et ne pas être trop commun.
									</small>
								</div>
							</div>

							<div class="mb-4">
								<label for="{{ form.new_password2.id_for_label }}" class="form-label">
									<i class="fas fa-check-double me-2"></i>Confirmer le nouveau mot de passe
								</label>
								<input type="password"
									class="form-control {% if form.new_password2.errors %}is-invalid{% endif %}"
									name="{{ form.new_password2.name }}" id="{{ form.new_password2.id_for_label }}"
									required>
								{% if form.new_password2.errors %}
								<div class="invalid-feedback">
									{% for error in form.new_password2.errors %}{{ error }}{% endfor %}
								</div>
								{% endif %}
							</div>

							<div class="d-flex justify-content-between">
								<a href="{% url 'user_profile' %}" class="btn btn-secondary">
									<i class="fas fa-arrow-left me-1"></i>Annuler
								</a>
								<button type="submit" class="btn btn-warning">
									<i class="fas fa-save me-1"></i>Changer le mot de passe
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
